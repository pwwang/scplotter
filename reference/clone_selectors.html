<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Helper functions to select clones based on various criteria — .get_data • scplotter</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Helper functions to select clones based on various criteria — .get_data"><meta name="description" content="These helper functions allow for the selection of clones based on various criteria such as size, group comparison, and existence in specific groups."><meta property="og:description" content="These helper functions allow for the selection of clones based on various criteria such as size, group comparison, and existence in specific groups."><meta property="og:image" content="https://pwwang.github.io/scplotter/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scplotter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Visualizing_data_with_LLMs.html">Visualizing data with LLMs</a></li>
    <li><a class="dropdown-item" href="../articles/Working_with_anndata_h5ad_files.html">Working with anndata (.h5ad) files</a></li>
    <li><a class="dropdown-item" href="../articles/Knowing_your_spatial_data_and_visualization.html">Knowing your spatial data and visualization</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-spatial-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Spatial Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-spatial-examples"><li><a class="dropdown-item" href="../articles/Seurat_10x_Visium.html">Visualizing 10x Visium data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_10x_VisiumHD.html">Visualizing 10x VisiumHD data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_SlideSeq.html">Visualizing SlideSeq data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Xenium.html">Visualizing Xenium data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Nanostring_CosMx.html">Visualizing Nanostring CosMx data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Akoya_CODEX.html">Visualizing Akoya_CODEX data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Visium.html">Visualizing Visium data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_VisiumHD.html">Visualizing VisiumHD data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Xenium.html">Visualizing Xenium data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_SlideSeq.html">Visualizing SlideSeq data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Spatial_CITE-Seq.html">Visualizing Spatial CITE-Seq data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Nanostring_CosMx.html">Visualizing Nanostirng CosMx data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_CODEX.html">Visualizing CODEX data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_vizgen.html">Visualizing vizgen data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_seqFISH.html">Visualizing seqFISH data prepared with Giotto</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pwwang/scplotter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Helper functions to select clones based on various criteria</h1>
      <small class="dont-index">Source: <a href="https://github.com/pwwang/scplotter/blob/master/R/clonalutils.R" class="external-link"><code>R/clonalutils.R</code></a></small>
      <div class="d-none name"><code>clone_selectors.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These helper functions allow for the selection of clones based on various criteria such as size, group comparison, and existence in specific groups.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">.get_data</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">.return_what</span><span class="op">(</span><span class="va">data</span>, <span class="va">id</span>, <span class="va">return_all</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">top</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"CTaa"</span>,</span>
<span>  return_all <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sel</span><span class="op">(</span><span class="va">expr</span>, groups <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span>, id <span class="op">=</span> <span class="st">"CTaa"</span>, return_all <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">uniq</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"CTaa"</span>,</span>
<span>  return_all <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">shared</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"CTaa"</span>,</span>
<span>  return_all <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gt</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"CTaa"</span>,</span>
<span>  return_all <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ge</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"CTaa"</span>,</span>
<span>  return_all <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lt</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"CTaa"</span>,</span>
<span>  return_all <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">le</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"CTaa"</span>,</span>
<span>  return_all <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">eq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span>, id <span class="op">=</span> <span class="st">"CTaa"</span>, return_all <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ne</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"CTaa"</span>,</span>
<span>  return_all <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">and</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">or</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data frame containing clone information. Default is NULL. If NULL, it will get data from parent.frame.
A typical <code>data</code> should have a column named <code>CTaa</code> and other columns for the groupings.
Supposingly it should be a grouped data frame with the grouping columns.
Under each grouping column, the value should be the size of the clone.
By default, the data is assumed to be in the parent frame.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>The column name that contains the clone ID. Default is "CTaa".</p></dd>


<dt id="arg-return-all">return_all<a class="anchor" aria-label="anchor" href="#arg-return-all"></a></dt>
<dd><p>If TRUE, the function returns a vector with the same length as the data, with CTaa values for selected clones and NA for others.
If FALSE, it returns a subset data frame with only the selected clones.
Default is NULL, which will be determined based on the data. If the function is used in a context of dplyr verbs, it defaults to TRUE.
Otherwise, it defaults to FALSE.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>The number of top clones to select or the threshold size.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>The column names in the meta data to group the cells.
By default, it is assumed <code>facet_by</code> and <code>split_by</code> to be in the parent frame.</p></dd>


<dt id="arg-expr">expr<a class="anchor" aria-label="anchor" href="#arg-expr"></a></dt>
<dd><p>The expression (in characters) to filter the clones
(e.g. "group1 &gt; group2" to select clones where group1 is larger than group2).</p></dd>


<dt id="arg-group-">group1<a class="anchor" aria-label="anchor" href="#arg-group-"></a></dt>
<dd><p>The first group to compare.</p></dd>


<dt id="arg-group-">group2<a class="anchor" aria-label="anchor" href="#arg-group-"></a></dt>
<dd><p>The second group to compare.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>More groups to compare.</p></dd>


<dt id="arg-include-zeros">include_zeros<a class="anchor" aria-label="anchor" href="#arg-include-zeros"></a></dt>
<dd><p>Whether to include clones with zero size in the comparison.
If TRUE, in a comparison (s1 &gt; s2) for a clone to be selected, both s1 and s2 must be greater than 0.
If FALSE, only the first group must be greater than the second group.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The first vector to compare in logical operations (and/or).</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The second vector to compare in logical operations (and/or).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of CTaas or a data frame with the selected clones based on the criteria.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    CTaa <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>    group1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    group2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">9</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">group1</span> <span class="op">+</span> <span class="va">data</span><span class="op">$</span><span class="va">group2</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">top</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    9      8      6      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    8      7      4      B</span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">top</span><span class="op">(</span><span class="fl">3</span>, groups <span class="op">=</span> <span class="st">"groups"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   groups [2]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     7      6      9 B     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     9      8      6 B     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     8      7      4 B     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     3      2      8 A     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>     1      0      7 A     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>     4      3      2 A     </span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">sel</span><span class="op">(</span><span class="va">group1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">group2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   10      9      0      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1      0      7      A</span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">uniq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   10      9      0      B</span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">shared</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    9      8      6      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    8      7      4      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    6      5      5      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    4      3      2      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    5      4      1      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    2      1      3      A</span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">gt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    9      8      6      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    8      7      4      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   10      9      0      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    4      3      2      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    5      4      1      B</span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">lt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    1      0      7      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    2      1      3      A</span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">le</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    6      5      5      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    1      0      7      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    2      1      3      A</span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">lt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, include_zeros <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    2      1      3      A</span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">eq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    6      5      5      B</span>
<span class="r-in"><span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">ne</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    9      8      6      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    8      7      4      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   10      9      0      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    1      0      7      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    4      3      2      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    5      4      1      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    2      1      3      A</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use them in a dplyr pipeline</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Top3 <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">top</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups Top3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B    9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A   NA</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Top3 <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">top</span><span class="op">(</span><span class="fl">3</span>, groups <span class="op">=</span> <span class="st">"groups"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups Top3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B    9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A   NA</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Unique <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">sel</span><span class="op">(</span><span class="va">group1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">group2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups Unique</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B     10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A     NA</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, UniqueInG1 <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">uniq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups UniqueInG1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B         10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A         NA</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Shared <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">shared</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups Shared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B      7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B      9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B      8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B      6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A      4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B      5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A      2</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Greater <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">gt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups Greater</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B       9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B       8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B       5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A      NA</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Less <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">lt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups Less</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A    2</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, LessEqual <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">le</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups LessEqual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B         6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A         2</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, GreaterEqual <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">ge</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups GreaterEqual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B            9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B            8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B            6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B           10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A            4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A           NA</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Equal <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">eq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups Equal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B     6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A    NA</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, NotEqual <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">ne</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups NotEqual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B        7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B        8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B       10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A        4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A        2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compond expressions</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  Top3OrEqual <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">or</span><span class="op">(</span><span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">top</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">eq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups Top3OrEqual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B           7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B           9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B           8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B           6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A          NA</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  SharedAndGreater <span class="op">=</span> <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">and</span><span class="op">(</span></span></span>
<span class="r-in"><span>     <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">shared</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span>, <span class="fu">scplotter</span><span class="fu">:::</span><span class="fu">gt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa group1 group2 groups SharedAndGreater</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     7      6      9      B               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     9      8      6      B                9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     8      7      4      B                8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3      2      8      A               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6      5      5      B               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   10      9      0      B               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1      0      7      A               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4      3      2      A                4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5      4      1      B                5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2      1      3      A               NA</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Panwen Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

