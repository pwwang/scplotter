<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Helper functions to select clones based on various criteria — CloneSelectors • scplotter</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Helper functions to select clones based on various criteria — CloneSelectors"><meta name="description" content="These helper functions allow for the selection of clones based on various criteria such as size, group comparison, and existence in specific groups."><meta property="og:description" content="These helper functions allow for the selection of clones based on various criteria such as size, group comparison, and existence in specific groups."><meta property="og:image" content="https://pwwang.github.io/scplotter/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scplotter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Visualizing_data_with_LLMs.html">Visualizing data with LLMs</a></li>
    <li><a class="dropdown-item" href="../articles/Working_with_anndata_h5ad_files.html">Working with anndata (.h5ad) files</a></li>
    <li><a class="dropdown-item" href="../articles/Knowing_your_spatial_data_and_visualization.html">Knowing your spatial data and visualization</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-spatial-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Spatial Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-spatial-examples"><li><a class="dropdown-item" href="../articles/Seurat_10x_Visium.html">Visualizing 10x Visium data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_10x_VisiumHD.html">Visualizing 10x VisiumHD data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_SlideSeq.html">Visualizing SlideSeq data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Xenium.html">Visualizing Xenium data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Nanostring_CosMx.html">Visualizing Nanostring CosMx data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Akoya_CODEX.html">Visualizing Akoya_CODEX data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Visium.html">Visualizing Visium data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_VisiumHD.html">Visualizing VisiumHD data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Xenium.html">Visualizing Xenium data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_SlideSeq.html">Visualizing SlideSeq data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Spatial_CITE-Seq.html">Visualizing Spatial CITE-Seq data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Nanostring_CosMx.html">Visualizing Nanostirng CosMx data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_CODEX.html">Visualizing CODEX data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_vizgen.html">Visualizing vizgen data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_seqFISH.html">Visualizing seqFISH data prepared with Giotto</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pwwang/scplotter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Helper functions to select clones based on various criteria</h1>
      <small class="dont-index">Source: <a href="https://github.com/pwwang/scplotter/blob/master/R/clonalutils.R" class="external-link"><code>R/clonalutils.R</code></a></small>
      <div class="d-none name"><code>clone_selectors.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These helper functions allow for the selection of clones based on various criteria such as size, group comparison, and existence in specific groups.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">top</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sel</span><span class="op">(</span></span>
<span>  <span class="va">expr</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">uniq</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">shared</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gt</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ge</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lt</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">le</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">eq</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ne</span><span class="op">(</span></span>
<span>  <span class="va">group1</span>,</span>
<span>  <span class="va">group2</span>,</span>
<span>  include_zeros <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in_form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">and</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">or</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>The number of top clones to select or the threshold size.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>The column names in the meta data to group the cells.
By default, it is assumed <code>facet_by</code> and <code>split_by</code> to be in the parent frame if used in scplotter functions.
When used in dplyr verbs, it should be a character vector of the grouping columns, where the first column is used to
extract the values (count) for <code>group1</code>, <code>group2</code>, and <code>...</code> and the rest are used to keep the groupings.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data frame containing clone information. Default is NULL. If NULL,
when used in scplotter functions, it will get data from parent.frame.
A typical <code>data</code> should have a column named <code>CloneID</code> and other columns for the groupings.
Supposingly it should be a grouped data frame with the grouping columns.
Under each grouping column, the value should be the size of the clone.
By default, the data is assumed to be in the parent frame.
When used in dplyr verbs, it should be the parent data frame passed to the dplyr verb.</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>The order of the clones to select. It can be an expression to order the clones by a specific column. Only used in <code>top()</code>.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>The column name that contains the clone ID. Default is "CTaa".</p></dd>


<dt id="arg-in-form">in_form<a class="anchor" aria-label="anchor" href="#arg-in-form"></a></dt>
<dd><p>The format of the input data. It can be "long" or "wide".
If "long", the data should be in a long format with a column for the clone IDs and a column for the size.
If "wide", the data should be in a wide format with columns for the clone IDs and the size for each group.
When used in dplyr verbs, it should be "long" by default.
If used in scplotter functions, it should be "wide" by default.#'</p></dd>


<dt id="arg-within">within<a class="anchor" aria-label="anchor" href="#arg-within"></a></dt>
<dd><p>An expression passed to subset the data before applying the selection criteria.
Only works for <code>long</code> format. It is useful when you want to select clones based on the criteria within a specific subset of the data.
Note that this subsetting is only applied to determine the selection of clones, not to the final output.
So if a cell belongs to a clone that is selected based on the subsetted data, it will be included in the final output, even
if it does not meet the <code>within</code> criteria. If you want the clones returned to also meet the <code>within</code> criteria,
you can set <code>output_within</code> to TRUE, which will return the clones that meet both the selection criteria and the <code>within</code> criteria.</p></dd>


<dt id="arg-output-within">output_within<a class="anchor" aria-label="anchor" href="#arg-output-within"></a></dt>
<dd><p>An expression passed to subset the data after applying the selection criteria.
Can work with both <code>long</code> and <code>wide</code> format.
It is useful when you want to return clones that meet both the selection criteria and this criteria.
If set to TRUE (only works when <code>within</code> is specified), the <code>within</code> criteria will be applied to filter the final output to include only the clones that meet both the selection criteria and the <code>within</code> criteria.
If FALSE or NULL (default), the <code>within</code> criteria will only be applied to determine the selection of clones, not to the final output.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>There are three options for the output: "id" (or "ids"), "logical" (or "bool", "boolean", "indicator"), and "data" (or "df", "data.frame").</p><ul><li><p>"id" (or "ids"): return a vector with the same length as the input data, with the selected clones' CTaa values (clone IDs) and NA for others. It is useful for adding a new column to the data frame.</p></li>
<li><p>"logical" (or "bool", "boolean", "indicator"): return a logical vector indicating whether each clone is selected or not. Same as <code>id</code> but with TRUE for selected clones and FALSE for others.</p></li>
<li><p>"data" (or "df", "data.frame"): return a subset of the data frame with only the selected clones. This is useful for filtering the data frame to only include the clones that meet the criteria. It is used internally in some other scplotter functions, such as <code>ClonalStatPlot</code>, to select clones. The groupings are also applied, and defaulting to <code>facet_by</code> and <code>split_by</code> in the parent frame.
By default, it is NULL, which will return "id" when used in dplyr verbs and "data" when used in scplotter functions.</p></li>
</ul></dd>


<dt id="arg-expr">expr<a class="anchor" aria-label="anchor" href="#arg-expr"></a></dt>
<dd><p>The expression (in characters) to filter the clones
(e.g. "group1 &gt; group2" to select clones where group1 is larger than group2).</p></dd>


<dt id="arg-group-">group1<a class="anchor" aria-label="anchor" href="#arg-group-"></a></dt>
<dd><p>The first group to compare.</p></dd>


<dt id="arg-group-">group2<a class="anchor" aria-label="anchor" href="#arg-group-"></a></dt>
<dd><p>The second group to compare.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional vectors to compare in logical operations (and/or).</p></dd>


<dt id="arg-include-zeros">include_zeros<a class="anchor" aria-label="anchor" href="#arg-include-zeros"></a></dt>
<dd><p>Whether to include clones with zero size in the comparison.
If TRUE, in a comparison (s1 &gt; s2) for a clone to be selected, both s1 and s2 must be greater than 0.
If FALSE, only the first group must be greater than the second group.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The first vector to compare in logical operations (and/or).</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The second vector to compare in logical operations (and/or).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of CTaas or a data frame with the selected clones based on the criteria.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These helper functions are designed to be used in a dplyr pipeline or used internally in other scplotter
functions to select clones based on various criteria.</p><ul><li><p>When used in a dplyr pipeline, they will return a vector with the same length as the input data, with the selected
clones' CTaa values (clone IDs) and NA for others. It is useful for adding a new column to the data frame. For the
functions that need <code>group1</code>, <code>group2</code>, and/or <code>...</code>, <code>groups</code> should be provided to specify the grouping columns.
Then <code>group1</code>, <code>group2</code>, and <code>...</code> can be the values in the grouping column. To include more grouping columns, just use
<code>c(grouping1, grouping2, ...)</code>, where <code>grouping1</code> is used for values of <code>group1</code>, <code>group2</code> and <code>...</code>; <code>grouping2</code> and
so on will be kept as the groupings where the clones are selected in each combination of the grouping values.</p></li>
<li><p>When used in a scplotter function, they will return a subset of the data frame with only the selected clones.
This is useful for filtering the data frame to only include the clones that meet the criteria. It is used internally in
some other scplotter functions, such as <code>ClonalStatPlot</code>, to select clones. The groupings are also applied, and defaulting
to <code>facet_by</code> and <code>split_by</code> in the parent frame.</p></li>
<li><p>When used independently, you should pass the arguments explicitly, such as <code>groups</code> and <code>output</code>, to control the
behavior and the output of the function.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8525</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    CTaa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AA1"</span>, <span class="st">"AA2"</span>, <span class="st">"AA3"</span>, <span class="st">"AA4"</span>, <span class="st">"AA5"</span>, <span class="st">"AA6"</span>, <span class="st">"AA7"</span>, <span class="st">"AA8"</span>, <span class="st">"AA9"</span>, <span class="st">"AA10"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    group1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    group2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">9</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">group1</span> <span class="op">+</span> <span class="va">data</span><span class="op">$</span><span class="va">group2</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">top</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  AA7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  AA9      8      6      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  AA8      7      4      B</span>
<span class="r-in"><span><span class="fu">top</span><span class="op">(</span><span class="fl">3</span>, groups <span class="op">=</span> <span class="st">"groups"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   groups [2]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa  group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> AA7        6      9 B     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> AA9        8      6 B     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> AA8        7      4 B     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> AA3        2      8 A     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> AA1        0      7 A     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> AA4        3      2 A     </span>
<span class="r-in"><span><span class="fu">sel</span><span class="op">(</span><span class="va">group1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">group2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 AA10      9      0      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  AA1      0      7      A</span>
<span class="r-in"><span><span class="fu">uniq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 AA10      9      0      B</span>
<span class="r-in"><span><span class="fu">shared</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  AA7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  AA9      8      6      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  AA8      7      4      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  AA3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  AA6      5      5      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  AA4      3      2      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  AA5      4      1      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  AA2      1      3      A</span>
<span class="r-in"><span><span class="fu">gt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  AA9      8      6      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  AA8      7      4      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 AA10      9      0      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  AA4      3      2      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  AA5      4      1      B</span>
<span class="r-in"><span><span class="fu">lt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  AA7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  AA3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  AA1      0      7      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  AA2      1      3      A</span>
<span class="r-in"><span><span class="fu">le</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  AA7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  AA3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  AA6      5      5      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  AA1      0      7      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  AA2      1      3      A</span>
<span class="r-in"><span><span class="fu">lt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, include_zeros <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  AA7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  AA3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  AA2      1      3      A</span>
<span class="r-in"><span><span class="fu">eq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  AA6      5      5      B</span>
<span class="r-in"><span><span class="fu">ne</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CTaa group1 group2 groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  AA7      6      9      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  AA9      8      6      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  AA8      7      4      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  AA3      2      8      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 AA10      9      0      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  AA1      0      7      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  AA4      3      2      A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  AA5      4      1      B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  AA2      1      3      A</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use them in a dplyr pipeline</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">data</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group1"</span>, <span class="st">"group2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    names_to <span class="op">=</span> <span class="st">"group"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/uncount.html" class="external-link">uncount</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">!</span><span class="op">!</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="st">"value"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Take a glimpse of the data</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa  groups group  subset</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AA8   B      group2 S1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AA8   B      group1 S1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AA5   B      group1 S1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AA10  B      group1 S1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AA7   B      group1 S2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AA7   B      group1 S1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AA1   A      group2 S2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AA1   A      group2 S1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AA5   B      group1 S1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AA9   B      group1 S2    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Top3 <span class="op">=</span> <span class="fu">top</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Top3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "AA7" "AA9" "AA8" NA   </span>
<span class="r-in"><span><span class="co"># Note that AA9 also reported in S2, even though the comparison is only applied within S1</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Top3 <span class="op">=</span> <span class="fu">top</span><span class="op">(</span><span class="fl">3</span>, within <span class="op">=</span> <span class="va">subset</span> <span class="op">==</span> <span class="st">"S1"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="va">CTaa</span>, <span class="va">subset</span>, <span class="va">Top3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 19 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa  subset Top3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AA7   S2     AA7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AA7   S1     AA7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AA9   S1     AA9  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AA9   S2     AA9  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AA8   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AA8   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AA3   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AA3   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AA6   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AA6   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> AA10  S2     AA10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> AA10  S1     AA10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> AA1   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> AA1   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> AA4   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> AA4   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> AA5   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> AA2   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> AA2   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span><span class="co"># Note that AA9 is now excluded</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Top3 <span class="op">=</span> <span class="fu">top</span><span class="op">(</span><span class="fl">3</span>, within <span class="op">=</span> <span class="va">subset</span> <span class="op">==</span> <span class="st">"S1"</span>, output_within <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="va">CTaa</span>, <span class="va">subset</span>, <span class="va">Top3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 19 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa  subset Top3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AA7   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AA7   S1     AA7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AA9   S1     AA9  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AA9   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AA8   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AA8   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AA3   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AA3   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AA6   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AA6   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> AA10  S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> AA10  S1     AA10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> AA1   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> AA1   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> AA4   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> AA4   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> AA5   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> AA2   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> AA2   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span><span class="co"># We can also exclude S1 clones even when the comparison is applied within S1</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Top3 <span class="op">=</span> <span class="fu">top</span><span class="op">(</span><span class="fl">3</span>, within <span class="op">=</span> <span class="va">subset</span> <span class="op">==</span> <span class="st">"S1"</span>, output_within <span class="op">=</span> <span class="va">subset</span> <span class="op">==</span> <span class="st">"S2"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="va">CTaa</span>, <span class="va">subset</span>, <span class="va">Top3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 19 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CTaa  subset Top3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AA7   S2     AA7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AA7   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AA9   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AA9   S2     AA9  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> AA8   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> AA8   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> AA3   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> AA3   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> AA6   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> AA6   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> AA10  S2     AA10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> AA10  S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> AA1   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> AA1   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> AA4   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> AA4   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> AA5   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> AA2   S1     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> AA2   S2     <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Top3 <span class="op">=</span> <span class="fu">top</span><span class="op">(</span><span class="fl">3</span>, groups <span class="op">=</span> <span class="st">"groups"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Top3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "AA7" "AA9" "AA8" "AA3" NA    "AA1" "AA4"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Unique <span class="op">=</span> <span class="fu">sel</span><span class="op">(</span><span class="va">group1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">group2</span> <span class="op">==</span> <span class="fl">0</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Unique</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA     "AA10" "AA1" </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, UniqueInG1 <span class="op">=</span> <span class="fu">uniq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">UniqueInG1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA     "AA10"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Shared <span class="op">=</span> <span class="fu">shared</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Shared</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "AA7" "AA9" "AA8" "AA3" "AA6" NA    "AA4" "AA5" "AA2"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Greater <span class="op">=</span> <span class="fu">gt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Greater</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA     "AA9"  "AA8"  "AA10" "AA4"  "AA5" </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Less <span class="op">=</span> <span class="fu">lt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Less</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "AA7" NA    "AA3" "AA1" "AA2"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, LessEqual <span class="op">=</span> <span class="fu">le</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">LessEqual</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "AA7" NA    "AA3" "AA6" "AA1" "AA2"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, GreaterEqual <span class="op">=</span> <span class="fu">ge</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">GreaterEqual</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA     "AA9"  "AA8"  "AA6"  "AA10" "AA4"  "AA5" </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, Equal <span class="op">=</span> <span class="fu">eq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Equal</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA    "AA6"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>, NotEqual <span class="op">=</span> <span class="fu">ne</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">NotEqual</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "AA7"  "AA9"  "AA8"  "AA3"  NA     "AA10" "AA1"  "AA4"  "AA5"  "AA2" </span>
<span class="r-in"><span><span class="co"># Compond expressions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>     Top3OrEqual <span class="op">=</span> <span class="fu">or</span><span class="op">(</span><span class="fu">top</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fu">eq</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Top3OrEqual</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "AA7" "AA9" "AA8" NA    "AA6"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>     SharedAndGreater <span class="op">=</span> <span class="fu">and</span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu">shared</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu">gt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">SharedAndGreater</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA    "AA9" "AA8" "AA4" "AA5"</span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>   SharedAndGreater <span class="op">=</span> <span class="fu">and</span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu">shared</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span>, output <span class="op">=</span> <span class="st">"logical"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu">gt</span><span class="op">(</span><span class="va">group1</span>, <span class="va">group2</span>, groups <span class="op">=</span> <span class="st">"group"</span>, output <span class="op">=</span> <span class="st">"logical"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">$</span><span class="va">SharedAndGreater</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [73] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [85]  TRUE  TRUE FALSE FALSE FALSE FALSE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Panwen Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

