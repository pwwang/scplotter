<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ClonalStatPlot — ClonalStatPlot • scplotter</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ClonalStatPlot — ClonalStatPlot"><meta name="description" content="Visualize the statistics of the clones."><meta property="og:description" content="Visualize the statistics of the clones."><meta property="og:image" content="https://pwwang.github.io/scplotter/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scplotter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Visualizing_data_with_LLMs.html">Visualizing data with LLMs</a></li>
    <li><a class="dropdown-item" href="../articles/Working_with_anndata_h5ad_files.html">Working with anndata (.h5ad) files</a></li>
    <li><a class="dropdown-item" href="../articles/Knowing_your_spatial_data_and_visualization.html">Knowing your spatial data and visualization</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-spatial-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Spatial Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-spatial-examples"><li><a class="dropdown-item" href="../articles/Seurat_10x_Visium.html">Visualizing 10x Visium data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_10x_VisiumHD.html">Visualizing 10x VisiumHD data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_SlideSeq.html">Visualizing SlideSeq data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Xenium.html">Visualizing Xenium data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Nanostring_CosMx.html">Visualizing Nanostring CosMx data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Akoya_CODEX.html">Visualizing Akoya_CODEX data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Visium.html">Visualizing Visium data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_VisiumHD.html">Visualizing VisiumHD data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Xenium.html">Visualizing Xenium data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_SlideSeq.html">Visualizing SlideSeq data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Spatial_CITE-Seq.html">Visualizing Spatial CITE-Seq data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Nanostring_CosMx.html">Visualizing Nanostirng CosMx data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_CODEX.html">Visualizing CODEX data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_vizgen.html">Visualizing vizgen data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_seqFISH.html">Visualizing seqFISH data prepared with Giotto</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pwwang/scplotter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ClonalStatPlot</h1>
      <small class="dont-index">Source: <a href="https://github.com/pwwang/scplotter/blob/master/R/clonalstatplot.R" class="external-link"><code>R/clonalstatplot.R</code></a></small>
      <div class="d-none name"><code>ClonalStatPlot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Visualize the statistics of the clones.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ClonalStatPlot</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  clones <span class="op">=</span> <span class="st">"top(10)"</span>,</span>
<span>  clone_call <span class="op">=</span> <span class="st">"aa"</span>,</span>
<span>  chain <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  values_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"count"</span>, <span class="st">"fraction"</span>, <span class="st">"n"</span><span class="op">)</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bar"</span>, <span class="st">"box"</span>, <span class="st">"violin"</span>, <span class="st">"heatmap"</span>, <span class="st">"pies"</span>, <span class="st">"circos"</span>, <span class="st">"chord"</span>, <span class="st">"sankey"</span>,</span>
<span>    <span class="st">"alluvial"</span>, <span class="st">"trend"</span>, <span class="st">"col"</span><span class="op">)</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"Sample"</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subgroup_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subgroups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within_subgroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">plot_type</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"pies"</span>,</span>
<span>  relabel <span class="op">=</span> <span class="va">plot_type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col"</span>, <span class="st">"chord"</span>, <span class="st">"circos"</span><span class="op">)</span>,</span>
<span>  facet_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The product of <a href="https://www.borch.dev/uploads/scRepertoire/reference/combineTCR.html" class="external-link">scRepertoire::combineTCR</a>, <a href="https://www.borch.dev/uploads/scRepertoire/reference/combineTCR.html" class="external-link">scRepertoire::combineTCR</a>, or
<a href="https://www.borch.dev/uploads/scRepertoire/reference/combineExpression.html" class="external-link">scRepertoire::combineExpression</a>.</p></dd>


<dt id="arg-clones">clones<a class="anchor" aria-label="anchor" href="#arg-clones"></a></dt>
<dd><p>The specific clones to track. This argument must be provided.
If multiple character values are provided, they will be treated as clone IDs.
If a single character value is provided with parentheses, it will be evaluated as an expression to select the clones.
The clones will be selected per facetting/splitting group. For example, if you have
<code>top(3)</code> will select the top 3 clones in each facetting/splitting group.
You can change this behavior by passing the <code>group_by</code> argument explicitly.
For example <code>top(3, group_by = "Sample")</code> will select the top 3 clones in each sample.
For expression, see also <a href="clone_selectors.html"><code>clone_selectors</code></a>.
This can also be a named list of expressions, which need to be quoted. Then basic unit for visualization will be the
the clone groups defined by the names of the list, instead of single clones.</p></dd>


<dt id="arg-clone-call">clone_call<a class="anchor" aria-label="anchor" href="#arg-clone-call"></a></dt>
<dd><p>How to call the clone - VDJC gene (gene), CDR3 nucleotide (nt),
CDR3 amino acid (aa), VDJC gene + CDR3 nucleotide (strict) or a custom variable
in the data</p></dd>


<dt id="arg-chain">chain<a class="anchor" aria-label="anchor" href="#arg-chain"></a></dt>
<dd><p>indicate if both or a specific chain should be used - e.g. "both",
"TRA", "TRG", "IGH", "IGL"</p></dd>


<dt id="arg-values-by">values_by<a class="anchor" aria-label="anchor" href="#arg-values-by"></a></dt>
<dd><p>The variable to use for the values of the clones.
Default is "count", which represents the number of cells in each clone.
"fraction" can also be used to represent the fraction of cells in each clone out of the total cells in the group.
"n" can be used to represent the number of cells in each clone, same as "count".</p></dd>


<dt id="arg-plot-type">plot_type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>The type of plot to use. Default is "bar".
Possible values are:</p><ul><li><p>"bar" - bar plot showing the total size of the selected clones in each group.</p></li>
<li><p>"box" - box plot showing the distribution of the clone sizes in each group.</p></li>
<li><p>"violin" - violin plot showing the distribution of the clone sizes in each group.</p></li>
<li><p>"heatmap" - heatmap showing the clone sizes in each group.</p></li>
<li><p>"pies" - heatmap with pie charts showing the clone sizes and subgroup compositions in each group. Requires <code>subgroup_by</code> to be provided.</p></li>
<li><p>"sankey" - sankey plot showing the dynamics of the clones between groups. The clone groups will be defined by the <code>clones</code> argument. The flows will be colored by the clone groups.</p></li>
<li><p>"alluvial" - same as "sankey".</p></li>
<li><p>"trend" - line plot showing the trend of the clone sizes in each group. The clone groups will be defined by the <code>clones</code> argument. The lines will be colored by the clone groups.</p></li>
<li><p>"col" - column plot showing the size of the clones in each group.
Note that for "col", the plot will be faceted by the groups, so "facet_by" is not supported. Please use "split_by" instead if you want to split the plot by another variable.</p></li>
</ul></dd>


<dt id="arg-group-by">group_by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>The column name in the meta data to group the cells. Default: "Sample"</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>The groups to include in the plot. Default is NULL.
If NULL, all the groups in <code>group_by</code> will be included.</p></dd>


<dt id="arg-subgroup-by">subgroup_by<a class="anchor" aria-label="anchor" href="#arg-subgroup-by"></a></dt>
<dd><p>The column name in the meta data to subgroup the nodes (group nodes on each <code>x</code>). Default: NULL.
This argument is only supported for "sankey"/"alluvial" plot.
If NULL, the nodes will be grouped/colored by the clones</p></dd>


<dt id="arg-subgroups">subgroups<a class="anchor" aria-label="anchor" href="#arg-subgroups"></a></dt>
<dd><p>The subgroups to include in the plot. Default is NULL.</p></dd>


<dt id="arg-within-subgroup">within_subgroup<a class="anchor" aria-label="anchor" href="#arg-within-subgroup"></a></dt>
<dd><p>Whether to select the clones within each subgroup.</p></dd>


<dt id="arg-relabel">relabel<a class="anchor" aria-label="anchor" href="#arg-relabel"></a></dt>
<dd><p>Whether to relabel the clones. Default is FALSE.
The clone ids, especially using CDR3 sequences, can be long and hard to read.
If TRUE, the clones will be relabeled as "clone1", "clone2", etc. (ordered by the descending clone sizes)
Only works for visualizations for single clones.</p></dd>


<dt id="arg-facet-by">facet_by<a class="anchor" aria-label="anchor" href="#arg-facet-by"></a></dt>
<dd><p>The column name in the meta data to facet the plots. Default: NULL.
This argument is not supported and will raise an error if provided.</p></dd>


<dt id="arg-split-by">split_by<a class="anchor" aria-label="anchor" href="#arg-split-by"></a></dt>
<dd><p>The column name in the meta data to split the plots. Default: NULL</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The y-axis variable to use for the plot. Default is NULL.</p><ul><li><p>For <code>bar</code> plot, Either "TotalSize" or "Count" can be used, representing the total size (# cells) of the selected clones or the number of selected clones, respectively.</p></li>
</ul></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>The x-axis label. Default is NULL.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>The y-axis label. Default is NULL.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to the specific plot function.</p><ul><li><p>For <code>bar</code> plot, see <code><a href="https://pwwang.github.io/plotthis/reference/barplot.html" class="external-link">plotthis::BarPlot()</a></code>.</p></li>
<li><p>For <code>trend</code> plot, see <code><a href="https://pwwang.github.io/plotthis/reference/TrendPlot.html" class="external-link">plotthis::TrendPlot()</a></code>.</p></li>
<li><p>For <code>sankey</code> plot, see <code><a href="https://pwwang.github.io/plotthis/reference/sankeyplot.html" class="external-link">plotthis::SankeyPlot()</a></code>.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object or a list if <code>combine</code> is FALSE</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8525</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">contig_list</span>, package <span class="op">=</span> <span class="st">"scRepertoire"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">scRepertoire</span><span class="fu">::</span><span class="fu"><a href="https://www.borch.dev/uploads/scRepertoire/reference/combineTCR.html" class="external-link">combineTCR</a></span><span class="op">(</span><span class="va">contig_list</span>,</span></span>
<span class="r-in"><span>    samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span>, <span class="st">"P18B"</span>, <span class="st">"P18L"</span>, <span class="st">"P19B"</span>,<span class="st">"P19L"</span>, <span class="st">"P20B"</span>, <span class="st">"P20L"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">scRepertoire</span><span class="fu">::</span><span class="fu"><a href="https://www.borch.dev/uploads/scRepertoire/reference/addVariable.html" class="external-link">addVariable</a></span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>    variable.name <span class="op">=</span> <span class="st">"Type"</span>,</span></span>
<span class="r-in"><span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"L"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">scRepertoire</span><span class="fu">::</span><span class="fu"><a href="https://www.borch.dev/uploads/scRepertoire/reference/addVariable.html" class="external-link">addVariable</a></span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>    variable.name <span class="op">=</span> <span class="st">"Subject"</span>,</span></span>
<span class="r-in"><span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17"</span>, <span class="st">"P18"</span>, <span class="st">"P19"</span>, <span class="st">"P20"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># add a fake variable (e.g. cell type from scRNA-seq)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">x</span><span class="op">$</span><span class="va">CellType</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"B"</span>, <span class="st">"NK"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># showing the top 10 clones (by default)</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>, title <span class="op">=</span> <span class="st">"Top 10 clones"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># showing the top 10 clones in P17B and in P17L, with the clones relabeled</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, clones <span class="op">=</span> <span class="st">"top(10, group_by = 'Sample')"</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>,</span></span>
<span class="r-in"><span>    groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>, relabel <span class="op">=</span> <span class="cn">TRUE</span>, values_by <span class="op">=</span> <span class="st">"fraction"</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Top 10 clones in P17B and in P17L (relabelled)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># showing the top 10 clones in each sample using violin plots</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>,</span></span>
<span class="r-in"><span>    plot_type <span class="op">=</span> <span class="st">"violin"</span>, clones <span class="op">=</span> <span class="st">"top(10, group_by = 'Sample')"</span>,</span></span>
<span class="r-in"><span>    subgroup_by <span class="op">=</span> <span class="st">"CellType"</span>, subgroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD4"</span>, <span class="st">"CD8"</span><span class="op">)</span>, add_box <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    comparison <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Violin plots showing top 10 clones in each sample"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># showing selected clones in P17B and P17L</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    clones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CVVSDNTGGFKTIF_CASSVRRERANTGELFF"</span>, <span class="st">"NA_CASSVRRERANTGELFF"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Selected clones in P17B and P17L"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># facetting is supported, note that selection of clones is done within each facet</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Subject"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17"</span>, <span class="st">"P19"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    facet_by <span class="op">=</span> <span class="st">"Type"</span>, relabel <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Top 10 clones in Type B and L for P17 and P19"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># as well as splitting</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Subject"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17"</span>, <span class="st">"P19"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    split_by <span class="op">=</span> <span class="st">"Type"</span>, relabel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># showing top 10 shared clones between P17B and P17L</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    clones <span class="op">=</span> <span class="st">"shared(P17B, P17L, group_by = 'Sample', top = 10)"</span>, relabel <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Shared clones between P17B and P17L"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># showing clones larger than 10 in P17L and ordered by the clone size in P17L descendingly</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     clones <span class="op">=</span> <span class="st">"sel(P17B &gt; 10, group_by = 'Sample', top = 5, order = desc(P17B))"</span>,</span></span>
<span class="r-in"><span>     relabel <span class="op">=</span> <span class="cn">TRUE</span>, position <span class="op">=</span> <span class="st">"stack"</span>, title <span class="op">=</span> <span class="st">"Top 5 clones larger than 10 in P17B"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># using trend plot</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    clones <span class="op">=</span> <span class="st">"sel(P17L &gt; 10 &amp; P17B &gt; 0, group_by = 'Sample')"</span>, relabel <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    plot_type <span class="op">=</span> <span class="st">"trend"</span>, title <span class="op">=</span> <span class="st">"Clones larger than 10 in P17L and existing in P17B"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># using heatmap</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    clones <span class="op">=</span> <span class="st">"sel(P17L &gt; 10 &amp; P17B &gt; 0, group_by = 'Sample')"</span>, relabel <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, show_row_names <span class="op">=</span> <span class="cn">TRUE</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Clones larger than 10 in P17L and existing in P17B (heatmap)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># using pies with subgroups for groups of clones</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    clones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        ExpandedClonesInP17L <span class="op">=</span> <span class="st">"sel(P17L &gt; 20, group_by = 'Sample')"</span>,</span></span>
<span class="r-in"><span>        ExpandedClonesInP17B <span class="op">=</span> <span class="st">"sel(P17B &gt; 20, group_by = 'Sample')"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>, subgroup_by <span class="op">=</span> <span class="st">"CellType"</span>, pie_size <span class="op">=</span> <span class="va">sqrt</span>,</span></span>
<span class="r-in"><span>    plot_type <span class="op">=</span> <span class="st">"pies"</span>, show_row_names <span class="op">=</span> <span class="cn">TRUE</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Clones larger than 20 in P17L and P17B (pies with subgroups by CellType)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># using heatmap with subgroups for groups of clones</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   clones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>       ExpandedClonesInP17L <span class="op">=</span> <span class="st">"sel(P17L &gt; 20, group_by = 'Sample')"</span>,</span></span>
<span class="r-in"><span>       ExpandedClonesInP17B <span class="op">=</span> <span class="st">"sel(P17B &gt; 20, group_by = 'Sample')"</span></span></span>
<span class="r-in"><span>   <span class="op">)</span>, subgroup_by <span class="op">=</span> <span class="st">"CellType"</span>, pie_size <span class="op">=</span> <span class="va">sqrt</span>, within_subgroup <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, show_row_names <span class="op">=</span> <span class="cn">TRUE</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   title <span class="op">=</span> <span class="st">"Clones larger than 20 in P17L and P17B (pies with subgroups by CellType)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># using clone groups and showing dynamics using sankey plot</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, group_by <span class="op">=</span> <span class="st">"Sample"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    clones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"Hyper-expanded clones in P17B"</span> <span class="op">=</span> <span class="st">"sel(P17B &gt; 10, group_by = 'Sample')"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"Hyper-expanded clones in P17L"</span> <span class="op">=</span> <span class="st">"sel(P17L &gt; 10, group_by = 'Sample')"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>, plot_type <span class="op">=</span> <span class="st">"sankey"</span>, title <span class="op">=</span> <span class="st">"Hyper-expanded clones in P17B and P17L"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># col plot</span></span></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, clones <span class="op">=</span> <span class="st">"top(5, group_by = 'Sample')"</span>, plot_type <span class="op">=</span> <span class="st">"col"</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Top 5 clones in each sample (col plot)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, clones <span class="op">=</span> <span class="st">"top(5, group_by = 'Sample')"</span>, plot_type <span class="op">=</span> <span class="st">"col"</span>,</span></span>
<span class="r-in"><span>    values_by <span class="op">=</span> <span class="st">"fraction"</span>, facet_scale <span class="op">=</span> <span class="st">"free"</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Top 5 clones in each sample (col plot, showing fraction)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ClonalStatPlot</span><span class="op">(</span><span class="va">data</span>, plot_type <span class="op">=</span> <span class="st">"col"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P17B"</span>, <span class="st">"P17L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    facet_ncol <span class="op">=</span> <span class="fl">1</span>, legend.position <span class="op">=</span> <span class="st">"right"</span>,</span></span>
<span class="r-in"><span>    relabel <span class="op">=</span> <span class="cn">TRUE</span>, fill_by <span class="op">=</span> <span class="st">".Clones"</span>, fill_name <span class="op">=</span> <span class="st">"Clones"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ClonalStatPlot-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Panwen Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

