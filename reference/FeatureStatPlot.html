<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Feature statistic plot — FeatureStatPlot • scplotter</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Feature statistic plot — FeatureStatPlot"><meta name="description" content="This function creates various types of feature statistic plots for a Seurat object, a Giotto object,
a path to an .h5ad file or an opened H5File by hdf5r package.
It allows for plotting features such as gene expression, scores, or other metadata across different groups or conditions.
The function supports multiple plot types including violin, box, bar, ridge, dimension reduction, correlation, heatmap, and dot plots.
It can also handle multiple features and supports faceting, splitting, and grouping by metadata columns."><meta property="og:description" content="This function creates various types of feature statistic plots for a Seurat object, a Giotto object,
a path to an .h5ad file or an opened H5File by hdf5r package.
It allows for plotting features such as gene expression, scores, or other metadata across different groups or conditions.
The function supports multiple plot types including violin, box, bar, ridge, dimension reduction, correlation, heatmap, and dot plots.
It can also handle multiple features and supports faceting, splitting, and grouping by metadata columns."><meta property="og:image" content="https://pwwang.github.io/scplotter/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scplotter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Visualizing_data_with_LLMs.html">Visualizing data with LLMs</a></li>
    <li><a class="dropdown-item" href="../articles/Working_with_anndata_h5ad_files.html">Working with anndata (.h5ad) files</a></li>
    <li><a class="dropdown-item" href="../articles/Knowing_your_spatial_data_and_visualization.html">Knowing your spatial data and visualization</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-spatial-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Spatial Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-spatial-examples"><li><a class="dropdown-item" href="../articles/Seurat_10x_Visium.html">Visualizing 10x Visium data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_10x_VisiumHD.html">Visualizing 10x VisiumHD data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_SlideSeq.html">Visualizing SlideSeq data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Xenium.html">Visualizing Xenium data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Nanostring_CosMx.html">Visualizing Nanostring CosMx data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Seurat_Akoya_CODEX.html">Visualizing Akoya_CODEX data prepared with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Visium.html">Visualizing Visium data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_VisiumHD.html">Visualizing VisiumHD data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Xenium.html">Visualizing Xenium data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_SlideSeq.html">Visualizing SlideSeq data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Spatial_CITE-Seq.html">Visualizing Spatial CITE-Seq data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_Nanostring_CosMx.html">Visualizing Nanostirng CosMx data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_CODEX.html">Visualizing CODEX data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_vizgen.html">Visualizing vizgen data prepared with Giotto</a></li>
    <li><a class="dropdown-item" href="../articles/Giotto_seqFISH.html">Visualizing seqFISH data prepared with Giotto</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pwwang/scplotter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Feature statistic plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/pwwang/scplotter/blob/master/R/featurestatplot.R" class="external-link"><code>R/featurestatplot.R</code></a></small>
      <div class="d-none name"><code>FeatureStatPlot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates various types of feature statistic plots for a Seurat object, a Giotto object,
a path to an .h5ad file or an opened <code>H5File</code> by <code>hdf5r</code> package.
It allows for plotting features such as gene expression, scores, or other metadata across different groups or conditions.
The function supports multiple plot types including violin, box, bar, ridge, dimension reduction, correlation, heatmap, and dot plots.
It can also handle multiple features and supports faceting, splitting, and grouping by metadata columns.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FeatureStatPlot</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">features</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"violin"</span>, <span class="st">"box"</span>, <span class="st">"bar"</span>, <span class="st">"ridge"</span>, <span class="st">"dim"</span>, <span class="st">"cor"</span>, <span class="st">"heatmap"</span>, <span class="st">"dot"</span><span class="op">)</span>,</span>
<span>  spat_unit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feat_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  downsample <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pos_only <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"any"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  reduction <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  graph <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bg_cutoff <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>  rows_name <span class="op">=</span> <span class="st">"Features"</span>,</span>
<span>  ident <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  agg <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  group_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  facet_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_text_angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A seurat object, a giotto object, a path to an .h5ad file or an opened <code>H5File</code> by <code>hdf5r</code> package.</p></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>A character vector of feature names</p></dd>


<dt id="arg-plot-type">plot_type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>Type of the plot. It can be "violin", "box", "bar", "ridge", "dim", "cor", "heatmap" or "dot"</p></dd>


<dt id="arg-spat-unit">spat_unit<a class="anchor" aria-label="anchor" href="#arg-spat-unit"></a></dt>
<dd><p>The spatial unit to use for the plot. Only applied to Giotto objects.</p></dd>


<dt id="arg-feat-type">feat_type<a class="anchor" aria-label="anchor" href="#arg-feat-type"></a></dt>
<dd><p>feature type of the features (e.g. "rna", "dna", "protein"), only applied to Giotto objects.</p></dd>


<dt id="arg-downsample">downsample<a class="anchor" aria-label="anchor" href="#arg-downsample"></a></dt>
<dd><p>A numeric the number of cells in each identity group to downsample to for violin, box, or ridge plots.
If n &gt; 1, it is treated as the number of cells to downsample to.
If 0 &lt; n &lt;= 1, it is treated as the fraction of cells to downsample to.</p></dd>


<dt id="arg-pos-only">pos_only<a class="anchor" aria-label="anchor" href="#arg-pos-only"></a></dt>
<dd><p>Whether to only include cells with positive feature values.</p><ul><li><p>"no": Do not filter cells based on feature values. (default)</p></li>
<li><p>"any": Include cells with positive values for any of the features.</p></li>
<li><p>"all": Include cells with positive values for all of the features.
If you have named features (i.e. a named list), <code>pos_only</code> will be applied to all flattened features.</p></li>
</ul></dd>


<dt id="arg-reduction">reduction<a class="anchor" aria-label="anchor" href="#arg-reduction"></a></dt>
<dd><p>Name of the reduction to plot (for example, "umap"), only used when <code>plot_type</code> is "dim" or you can to use the reduction as feature.</p></dd>


<dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>Specify the graph name to add edges between cell neighbors to the plot, only used when <code>plot_type</code> is "dim".</p></dd>


<dt id="arg-bg-cutoff">bg_cutoff<a class="anchor" aria-label="anchor" href="#arg-bg-cutoff"></a></dt>
<dd><p>Background cutoff for the dim plot, only used when <code>plot_type</code> is "dim".</p></dd>


<dt id="arg-dims">dims<a class="anchor" aria-label="anchor" href="#arg-dims"></a></dt>
<dd><p>Dimensions to plot, only used when <code>plot_type</code> is "dim".</p></dd>


<dt id="arg-rows-name">rows_name<a class="anchor" aria-label="anchor" href="#arg-rows-name"></a></dt>
<dd><p>The name of the rows in the heatmap, only used when <code>plot_type</code> is "heatmap".</p></dd>


<dt id="arg-ident">ident<a class="anchor" aria-label="anchor" href="#arg-ident"></a></dt>
<dd><p>The column name in the meta data to identify the cells.</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>The assay to use for the feature data.</p></dd>


<dt id="arg-layer">layer<a class="anchor" aria-label="anchor" href="#arg-layer"></a></dt>
<dd><p>The layer to use for the feature data.</p></dd>


<dt id="arg-agg">agg<a class="anchor" aria-label="anchor" href="#arg-agg"></a></dt>
<dd><p>The aggregation function to use for the bar plot.</p></dd>


<dt id="arg-group-by">group_by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>The column name in the meta data to group the cells.</p></dd>


<dt id="arg-split-by">split_by<a class="anchor" aria-label="anchor" href="#arg-split-by"></a></dt>
<dd><p>Column name in the meta data to split the cells to different plots.
If TRUE, the cells are split by the features.</p></dd>


<dt id="arg-facet-by">facet_by<a class="anchor" aria-label="anchor" href="#arg-facet-by"></a></dt>
<dd><p>Column name in the meta data to facet the plots. Should be always NULL.</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>The x-axis label.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>The y-axis label.</p></dd>


<dt id="arg-x-text-angle">x_text_angle<a class="anchor" aria-label="anchor" href="#arg-x-text-angle"></a></dt>
<dd><p>The angle of the x-axis text. Only used when <code>plot_type</code> is "violin", "bar", or "box".</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to the plot functions.</p><ul><li><p>For <code>plot_type</code> "violin", the arguments are passed to <code><a href="https://pwwang.github.io/plotthis/reference/boxviolinplot.html" class="external-link">plotthis::ViolinPlot()</a></code>.</p></li>
<li><p>For <code>plot_type</code> "box", the arguments are passed to <code><a href="https://pwwang.github.io/plotthis/reference/boxviolinplot.html" class="external-link">plotthis::BoxPlot()</a></code>.</p></li>
<li><p>For <code>plot_type</code> "bar", the arguments are passed to <code><a href="https://pwwang.github.io/plotthis/reference/barplot.html" class="external-link">plotthis::BarPlot()</a></code>.</p></li>
<li><p>For <code>plot_type</code> "ridge", the arguments are passed to <code><a href="https://pwwang.github.io/plotthis/reference/RidgePlot.html" class="external-link">plotthis::RidgePlot()</a></code>.</p></li>
<li><p>For <code>plot_type</code> "dim", the arguments are passed to <code><a href="https://pwwang.github.io/plotthis/reference/dimplot.html" class="external-link">plotthis::FeatureDimPlot()</a></code>.</p></li>
<li><p>For <code>plot_type</code> "heatmap", the arguments are passed to <code><a href="https://pwwang.github.io/plotthis/reference/Heatmap.html" class="external-link">plotthis::Heatmap()</a></code>.</p></li>
<li><p>For <code>plot_type</code> "cor" with 2 features, the arguments are passed to <code><a href="https://pwwang.github.io/plotthis/reference/CorPlot.html" class="external-link">plotthis::CorPlot()</a></code>.</p></li>
<li><p>For <code>plot_type</code> "cor" with more than 2 features, the arguments are passed to <code><a href="https://pwwang.github.io/plotthis/reference/CorPairsPlot.html" class="external-link">plotthis::CorPairsPlot()</a></code>.</p></li>
<li><p>For <code>plot_type</code> "dot", the arguments are passed to <code><a href="https://pwwang.github.io/plotthis/reference/Heatmap.html" class="external-link">plotthis::Heatmap()</a></code> with <code>cell_type</code> set to "dot".</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object or a list if <code>combine</code> is FALSE</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See:</p><ul><li><p><a href="https://pwwang.github.io/scplotter/articles/Giotto_Visium.html">https://pwwang.github.io/scplotter/articles/Giotto_Visium.html</a></p></li>
<li><p><a href="https://pwwang.github.io/scplotter/articles/Giotto_Xenium.html">https://pwwang.github.io/scplotter/articles/Giotto_Xenium.html</a></p></li>
</ul><p>for examples of using this function with Giotto objects.</p>
<p>And see:</p><ul><li><p><a href="https://pwwang.github.io/scplotter/articles/Working_with_anndata_h5ad_files.html">https://pwwang.github.io/scplotter/articles/Working_with_anndata_h5ad_files.html</a></p></li>
</ul><p>for examples of using this function with .h5ad files.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pancreas_sub</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span>, <span class="st">"nCount_RNA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, facet_scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span>, <span class="st">"nCount_RNA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, plot_type <span class="op">=</span> <span class="st">"box"</span>, facet_scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span>, <span class="st">"nCount_RNA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>, facet_scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span>, <span class="st">"nCount_RNA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, plot_type <span class="op">=</span> <span class="st">"ridge"</span>, flip <span class="op">=</span> <span class="cn">TRUE</span>, facet_scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 0.0498</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 516</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 0.0498</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 516</span>
<span class="r-plt img"><img src="FeatureStatPlot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span>, <span class="st">"nCount_RNA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, facet_scales <span class="op">=</span> <span class="st">"free_y"</span>, add_point <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span>, <span class="st">"nCount_RNA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, facet_scales <span class="op">=</span> <span class="st">"free_y"</span>, add_trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span>, <span class="st">"nCount_RNA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, facet_scales <span class="op">=</span> <span class="st">"free_y"</span>, add_stat <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span>, <span class="st">"nCount_RNA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, facet_scales <span class="op">=</span> <span class="st">"free_y"</span>, group_by <span class="op">=</span> <span class="st">"Phase"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Groups with fewer than two datapoints have been dropped.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Set `drop = FALSE` to consider such groups for position adjustment purposes.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Groups with fewer than two datapoints have been dropped.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Set `drop = FALSE` to consider such groups for position adjustment purposes.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Groups with fewer than two datapoints have been dropped.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Set `drop = FALSE` to consider such groups for position adjustment purposes.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Groups with fewer than two datapoints have been dropped.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Set `drop = FALSE` to consider such groups for position adjustment purposes.</span>
<span class="r-plt img"><img src="FeatureStatPlot-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>       subset <span class="op">=</span> <span class="va">SubCellType</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ductal"</span>, <span class="st">"Ngn3 low EP"</span>, <span class="st">"Ngn3 high EP"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, group_by <span class="op">=</span> <span class="st">"Phase"</span>, comparisons <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detected more than 2 groups. Use multiple_method for comparison</span>
<span class="r-plt img"><img src="FeatureStatPlot-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rbp4"</span>, <span class="st">"Pyy"</span><span class="op">)</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>,</span></span>
<span class="r-in"><span>   add_bg <span class="op">=</span> <span class="cn">TRUE</span>, add_box <span class="op">=</span> <span class="cn">TRUE</span>, stack <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Use `pos_only` to include only cells with positive expression of all features</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rbp4"</span>, <span class="st">"Pyy"</span><span class="op">)</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>,</span></span>
<span class="r-in"><span>   add_bg <span class="op">=</span> <span class="cn">TRUE</span>, add_box <span class="op">=</span> <span class="cn">TRUE</span>, stack <span class="op">=</span> <span class="cn">TRUE</span>, pos_only <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>       <span class="st">"Sox9"</span>, <span class="st">"Anxa2"</span>, <span class="st">"Bicc1"</span>, <span class="co"># Ductal</span></span></span>
<span class="r-in"><span>       <span class="st">"Neurog3"</span>, <span class="st">"Hes6"</span>, <span class="co"># EPs</span></span></span>
<span class="r-in"><span>       <span class="st">"Fev"</span>, <span class="st">"Neurod1"</span>, <span class="co"># Pre-endocrine</span></span></span>
<span class="r-in"><span>       <span class="st">"Rbp4"</span>, <span class="st">"Pyy"</span>, <span class="co"># Endocrine</span></span></span>
<span class="r-in"><span>       <span class="st">"Ins1"</span>, <span class="st">"Gcg"</span>, <span class="st">"Sst"</span>, <span class="st">"Ghrl"</span> <span class="co"># Beta, Alpha, Delta, Epsilon</span></span></span>
<span class="r-in"><span>   <span class="op">)</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>, add_bg <span class="op">=</span> <span class="cn">TRUE</span>, stack <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   legend.position <span class="op">=</span> <span class="st">"top"</span>, legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"box"</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"Sox9"</span>, <span class="st">"Anxa2"</span>, <span class="st">"Bicc1"</span>, <span class="co"># Ductal</span></span></span>
<span class="r-in"><span>      <span class="st">"Neurog3"</span>, <span class="st">"Hes6"</span>, <span class="co"># EPs</span></span></span>
<span class="r-in"><span>      <span class="st">"Fev"</span>, <span class="st">"Neurod1"</span>, <span class="co"># Pre-endocrine</span></span></span>
<span class="r-in"><span>      <span class="st">"Rbp4"</span>, <span class="st">"Pyy"</span>, <span class="co"># Endocrine</span></span></span>
<span class="r-in"><span>      <span class="st">"Ins1"</span>, <span class="st">"Gcg"</span>, <span class="st">"Sst"</span>, <span class="st">"Ghrl"</span> <span class="co"># Beta, Alpha, Delta, Epsilon</span></span></span>
<span class="r-in"><span>   <span class="op">)</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>, add_bg <span class="op">=</span> <span class="cn">TRUE</span>, stack <span class="op">=</span> <span class="cn">TRUE</span>, flip <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   legend.position <span class="op">=</span> <span class="st">"top"</span>, legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Use splitting instead of facetting</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Neurog3"</span>, <span class="st">"Rbp4"</span>, <span class="st">"Ins1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"CellType"</span>, split_by <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"G2M_score"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"G2M_score"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   bg_cutoff <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"G2M_score"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   theme <span class="op">=</span> <span class="st">"theme_blank"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"G2M_score"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   theme <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span>, theme_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Label and highlight cell points</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"Rbp4"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   highlight <span class="op">=</span> <span class="st">'SubCellType == "Delta"'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>,</span></span>
<span class="r-in"><span>   features <span class="op">=</span> <span class="st">"Rbp4"</span>, split_by <span class="op">=</span> <span class="st">"Phase"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   highlight <span class="op">=</span> <span class="cn">TRUE</span>, theme <span class="op">=</span> <span class="st">"theme_blank"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-20.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a density layer</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"Rbp4"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   add_density <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-21.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"Rbp4"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   add_density <span class="op">=</span> <span class="cn">TRUE</span>, density_filled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 396 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_raster()`).</span>
<span class="r-plt img"><img src="FeatureStatPlot-22.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change the plot type from point to the hexagonal bin</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"Rbp4"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   hex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 4 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_hex()`).</span>
<span class="r-plt img"><img src="FeatureStatPlot-23.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"Rbp4"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   hex <span class="op">=</span> <span class="cn">TRUE</span>, hex_bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 3 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_hex()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 5 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_hex()`).</span>
<span class="r-plt img"><img src="FeatureStatPlot-24.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show lineages on the plot based on the pseudotime</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"Lineage3"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   lineages <span class="op">=</span> <span class="st">"Lineage3"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-25.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"Lineage3"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   lineages <span class="op">=</span> <span class="st">"Lineage3"</span>, lineages_whiskers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-26.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, features <span class="op">=</span> <span class="st">"Lineage3"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   lineages <span class="op">=</span> <span class="st">"Lineage3"</span>, lineages_span <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-27.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>,</span></span>
<span class="r-in"><span>  features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sox9"</span>, <span class="st">"Anxa2"</span>, <span class="st">"Bicc1"</span><span class="op">)</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>  theme <span class="op">=</span> <span class="st">"theme_blank"</span>,</span></span>
<span class="r-in"><span>  theme_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     strip.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-28.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot multiple features with different scales</span></span></span>
<span class="r-in"><span><span class="va">endocrine_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ins1"</span>, <span class="st">"Gcg"</span>, <span class="st">"Sst"</span>, <span class="st">"Ghrl"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, <span class="va">endocrine_markers</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-29.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, <span class="va">endocrine_markers</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>, lower_quantile <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>   upper_quantile <span class="op">=</span> <span class="fl">0.8</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-30.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, <span class="va">endocrine_markers</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   lower_cutoff <span class="op">=</span> <span class="fl">1</span>, upper_cutoff <span class="op">=</span> <span class="fl">4</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-31.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, <span class="va">endocrine_markers</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>, bg_cutoff <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>   lower_cutoff <span class="op">=</span> <span class="fl">2</span>, upper_cutoff <span class="op">=</span> <span class="fl">4</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-32.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sst"</span>, <span class="st">"Ghrl"</span><span class="op">)</span>, split_by <span class="op">=</span> <span class="st">"Phase"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"dim"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-33.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2M_score"</span>, <span class="st">"nCount_RNA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   ident <span class="op">=</span> <span class="st">"SubCellType"</span>, plot_type <span class="op">=</span> <span class="st">"dim"</span>, facet_by <span class="op">=</span> <span class="st">"Phase"</span>, split_by <span class="op">=</span> <span class="cn">TRUE</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-34.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Heatmap</span></span></span>
<span class="r-in"><span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="st">"Sox9"</span>, <span class="st">"Anxa2"</span>, <span class="st">"Bicc1"</span>, <span class="co"># Ductal</span></span></span>
<span class="r-in"><span>   <span class="st">"Neurog3"</span>, <span class="st">"Hes6"</span>, <span class="co"># EPs</span></span></span>
<span class="r-in"><span>   <span class="st">"Fev"</span>, <span class="st">"Neurod1"</span>, <span class="co"># Pre-endocrine</span></span></span>
<span class="r-in"><span>   <span class="st">"Rbp4"</span>, <span class="st">"Pyy"</span>, <span class="co"># Endocrine</span></span></span>
<span class="r-in"><span>   <span class="st">"Ins1"</span>, <span class="st">"Gcg"</span>, <span class="st">"Sst"</span>, <span class="st">"Ghrl"</span> <span class="co"># Beta, Alpha, Delta, Epsilon</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rows_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   Features <span class="op">=</span> <span class="va">features</span>,  <span class="co"># 'rows_name' default is "Features"</span></span></span>
<span class="r-in"><span>   group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>       <span class="st">"Ductal"</span>, <span class="st">"Ductal"</span>, <span class="st">"Ductal"</span>, <span class="st">"EPs"</span>, <span class="st">"EPs"</span>, <span class="st">"Pre-endocrine"</span>,</span></span>
<span class="r-in"><span>       <span class="st">"Pre-endocrine"</span>, <span class="st">"Endocrine"</span>, <span class="st">"Endocrine"</span>, <span class="st">"Beta"</span>, <span class="st">"Alpha"</span>, <span class="st">"Delta"</span>, <span class="st">"Epsilon"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   TF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>       <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   CSPA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>       <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="va">features</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, name <span class="op">=</span> <span class="st">"Expression Level"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-35.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="va">features</span>, ident <span class="op">=</span> <span class="st">"Phase"</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, name <span class="op">=</span> <span class="st">"Expression Level"</span>, columns_split_by <span class="op">=</span> <span class="st">"SubCellType"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-36.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="va">features</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, cell_type <span class="op">=</span> <span class="st">"bars"</span>, name <span class="op">=</span> <span class="st">"Expression Level"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-37.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="va">features</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>, cell_type <span class="op">=</span> <span class="st">"dot"</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, name <span class="op">=</span> <span class="st">"Expression Level"</span>, dot_size <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   dot_size_name <span class="op">=</span> <span class="st">"Percent Expressed"</span>, add_bg <span class="op">=</span> <span class="cn">TRUE</span>, rows_data <span class="op">=</span> <span class="va">rows_data</span>,</span></span>
<span class="r-in"><span>   show_row_names <span class="op">=</span> <span class="cn">TRUE</span>, rows_split_by <span class="op">=</span> <span class="st">"group"</span>, cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   column_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phase"</span>, <span class="st">"G2M_score"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   column_annotation_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Phase <span class="op">=</span> <span class="st">"pie"</span>, G2M_score <span class="op">=</span> <span class="st">"violin"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   column_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>G2M_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>show_legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TF"</span>, <span class="st">"CSPA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row_annotation_side <span class="op">=</span> <span class="st">"right"</span>,</span></span>
<span class="r-in"><span>   row_annotation_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>TF <span class="op">=</span> <span class="st">"simple"</span>, CSPA <span class="op">=</span> <span class="st">"simple"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[Heatmap] Assuming 'row_annotation_agg["TF"] = dplyr::first' for the simple annotation</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[Heatmap] Assuming 'row_annotation_agg["CSPA"] = dplyr::first' for the simple annotation</span>
<span class="r-plt img"><img src="FeatureStatPlot-38.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="va">features</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>, cell_type <span class="op">=</span> <span class="st">"dot"</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, name <span class="op">=</span> <span class="st">"Expression Level"</span>, dot_size <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   dot_size_name <span class="op">=</span> <span class="st">"Percent Expressed"</span>, add_bg <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   rows_data <span class="op">=</span> <span class="va">rows_data</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span>, rows_split_by <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>   cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, flip <span class="op">=</span> <span class="cn">TRUE</span>, palette <span class="op">=</span> <span class="st">"YlOrRd"</span>,</span></span>
<span class="r-in"><span>   column_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phase"</span>, <span class="st">"G2M_score"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   column_annotation_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Phase <span class="op">=</span> <span class="st">"pie"</span>, G2M_score <span class="op">=</span> <span class="st">"violin"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   column_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>G2M_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>show_legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TF"</span>, <span class="st">"CSPA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row_annotation_side <span class="op">=</span> <span class="st">"right"</span>,</span></span>
<span class="r-in"><span>   row_annotation_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>TF <span class="op">=</span> <span class="st">"simple"</span>, CSPA <span class="op">=</span> <span class="st">"simple"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[Heatmap] Assuming 'row_annotation_agg["TF"] = dplyr::first' for the simple annotation</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[Heatmap] Assuming 'row_annotation_agg["CSPA"] = dplyr::first' for the simple annotation</span>
<span class="r-plt img"><img src="FeatureStatPlot-39.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="va">features</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>, cell_type <span class="op">=</span> <span class="st">"violin"</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, name <span class="op">=</span> <span class="st">"Expression Level"</span>, show_row_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>, rows_split_by <span class="op">=</span> <span class="st">"group"</span>, rows_data <span class="op">=</span> <span class="va">rows_data</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-40.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="va">features</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>, cell_type <span class="op">=</span> <span class="st">"dot"</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, dot_size <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   dot_size_name <span class="op">=</span> <span class="st">"Percent Expressed"</span>, palette <span class="op">=</span> <span class="st">"viridis"</span>, add_reticle <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   rows_data <span class="op">=</span> <span class="va">rows_data</span>, name <span class="op">=</span> <span class="st">"Expression Level"</span>, show_row_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   rows_split_by <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-41.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Visualize the markers for each sub-cell type (the markers can overlap)</span></span></span>
<span class="r-in"><span><span class="co"># Say: markers &lt;- Seurat::FindAllMarkers(pancreas_sub, ident = "SubCellType")</span></span></span>
<span class="r-in"><span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    avg_log2FC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="fl">3.44</span>, <span class="fl">2.93</span>, <span class="fl">2.72</span>, <span class="fl">2.63</span>, <span class="fl">2.13</span>, <span class="fl">1.97</span>, <span class="fl">2.96</span>, <span class="fl">1.92</span>, <span class="fl">5.22</span>, <span class="fl">3.91</span>, <span class="fl">3.64</span>, <span class="fl">4.52</span>,</span></span>
<span class="r-in"><span>         <span class="fl">3.45</span>, <span class="fl">2.45</span>, <span class="fl">1.75</span>, <span class="fl">2.08</span>, <span class="fl">9.10</span>, <span class="fl">4.45</span>, <span class="fl">3.61</span>, <span class="fl">6.30</span>, <span class="fl">4.96</span>, <span class="fl">3.49</span>, <span class="fl">3.91</span>, <span class="fl">3.90</span>,</span></span>
<span class="r-in"><span>         <span class="fl">10.58</span>, <span class="fl">5.84</span>, <span class="fl">4.73</span>, <span class="fl">3.34</span>, <span class="fl">7.22</span>, <span class="fl">4.52</span>, <span class="fl">10.10</span>, <span class="fl">4.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ductal"</span>, <span class="st">"Ngn3 low EP"</span>, <span class="st">"Ngn3 high EP"</span>, <span class="st">"Pre-endocrine"</span>, <span class="st">"Beta"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"Alpha"</span>, <span class="st">"Delta"</span>, <span class="st">"Epsilon"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">pancreas_sub</span><span class="op">$</span><span class="va">SubCellType</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="st">"Cyr61"</span>, <span class="st">"Adamts1"</span>, <span class="st">"Anxa2"</span>, <span class="st">"Bicc1"</span>, <span class="st">"1700011H14Rik"</span>, <span class="st">"Gsta3"</span>, <span class="st">"8430408G22Rik"</span>,</span></span>
<span class="r-in"><span>         <span class="st">"Anxa2"</span>, <span class="st">"Ppp1r14a"</span>, <span class="st">"Btbd17"</span>, <span class="st">"Neurog3"</span>, <span class="st">"Gadd45a"</span>, <span class="st">"Fev"</span>, <span class="st">"Runx1t1"</span>, <span class="st">"Hmgn3"</span>,</span></span>
<span class="r-in"><span>         <span class="st">"Cryba2"</span>, <span class="st">"Ins2"</span>, <span class="st">"Ppp1r1a"</span>, <span class="st">"Gng12"</span>, <span class="st">"Sytl4"</span>, <span class="st">"Irx1"</span>, <span class="st">"Tmem27"</span>, <span class="st">"Peg10"</span>, <span class="st">"Irx2"</span>,</span></span>
<span class="r-in"><span>         <span class="st">"Sst"</span>, <span class="st">"Ptprz1"</span>, <span class="st">"Arg1"</span>, <span class="st">"Frzb"</span>, <span class="st">"Irs4"</span>, <span class="st">"Mboat4"</span>, <span class="st">"Ghrl"</span>, <span class="st">"Arg1"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">markers</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>, cell_type <span class="op">=</span> <span class="st">"bars"</span>,</span></span>
<span class="r-in"><span>  plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, rows_data <span class="op">=</span> <span class="va">markers</span>, rows_name <span class="op">=</span> <span class="st">"gene"</span>, rows_split_by <span class="op">=</span> <span class="st">"cluster"</span>,</span></span>
<span class="r-in"><span>  show_row_names <span class="op">=</span> <span class="cn">TRUE</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"Expression Level"</span>,</span></span>
<span class="r-in"><span>  cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>, rows_split_palette <span class="op">=</span> <span class="st">"Paired"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-42.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use plot_type = "dot" to as a shortcut for heatmap with cell_type = "dot"</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="va">features</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>, plot_type <span class="op">=</span> <span class="st">"dot"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-43.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">named_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   Ductal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sox9"</span>, <span class="st">"Anxa2"</span>, <span class="st">"Bicc1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   EPs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Neurog3"</span>, <span class="st">"Hes6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   `Pre-endocrine` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fev"</span>, <span class="st">"Neurod1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   Endocrine <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rbp4"</span>, <span class="st">"Pyy"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   Beta <span class="op">=</span> <span class="st">"Ins1"</span>, Alpha <span class="op">=</span> <span class="st">"Gcg"</span>, Delta <span class="op">=</span> <span class="st">"Sst"</span>, Epsilon <span class="op">=</span> <span class="st">"Ghrl"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="va">named_features</span>, ident <span class="op">=</span> <span class="st">"SubCellType"</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"heatmap"</span>, name <span class="op">=</span> <span class="st">"Expression Level"</span>, show_row_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-44.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Correlation plot</span></span></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pyy"</span>, <span class="st">"Rbp4"</span><span class="op">)</span>, plot_type <span class="op">=</span> <span class="st">"cor"</span>,</span></span>
<span class="r-in"><span>   anno_items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eq"</span>, <span class="st">"r2"</span>, <span class="st">"spearman"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-45.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">FeatureStatPlot</span><span class="op">(</span><span class="va">pancreas_sub</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ins1"</span>, <span class="st">"Gcg"</span>, <span class="st">"Sst"</span>, <span class="st">"Ghrl"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   plot_type <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="FeatureStatPlot-46.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Panwen Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

